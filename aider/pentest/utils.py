"""
Utilities for PentestAider scope management.
"""
import shutil

def load_scope(scope_file):
    """
    Load a newline-separated list of in-scope domains/IPs from a file.
    Returns a set of scope targets as strings.
    """
    try:
        with open(scope_file, "r") as f:
            lines = [line.strip() for line in f if line.strip() and not line.startswith("#")]
        return set(lines)
    except FileNotFoundError:
        return set()

def in_scope(host, scope):
    """
    Check if the given host is in the provided scope set.
    Basic substring or equality match.
    """
    for entry in scope:
        if entry in host or host == entry:
            return True
    return False

def command_exists(cmd):
    """
    Check if a command-line tool exists in the system PATH.
    """
    return shutil.which(cmd) is not None